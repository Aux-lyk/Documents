# 一、Android系统架构

# 二、活动

## 1、活动的生命周期

### 1.1、返回栈

android使用任务来管理活动，一个任务就是一组存放在栈里面的活动集合。后进先出，系统总是会显示处于栈顶端的活动给客户。

### 1.2、活动状态

- 运行状态：活动处于栈顶端。系统最不愿意回收
- 暂停状态：活动不处于栈顶端，但任然可见。内存极低时，系统考虑回收
- 停止状态：活动不处于栈顶端，并且完全不可见。其他地方需要内存，系统考虑回收
- 销毁状态：活动从返回栈中移除。系统最倾向回收

### 1.3、活动的生存周期

#### 1.3.1、Activity类中7个回调方法

1. onCreate() ：应该在此方法中完成活动的初始化操作，比如加载layout布局、绑定onClick事件等。
2. onStart() ：在活动由不可见变为可见时调用。
3. onResume() ：活动准备好和用户交互时调用。必须位于返回栈顶，并且处于运行状态。
4. onPause() ：系统准备启动或回复另一个活动时调用。通常会释放一些消耗CPU的资源，以及保存一些关键数据。但这些方法执行一定要快，不然会影响新的栈顶活动的使用。
5. onStop() ：活动完成不可见时调用。若启动的新活动是一个对话框式的非全屏活动，onPause() 会执行，onStop()不会执行。
6. onDestroy() ：被销毁前调用。
7. onRestat() ：活动由停止状态变为运行状态之前调用。

#### 1.3.2、3种生存周期

1. 完整生存期
   - 在onCreate()和onDestroy()间所经历的。
   - 一般会在onCreate()完成初始化操作，onDestroy()完成释放内存的操作。
2. 可见生存期
   - 在onStart()和onStop()间所经历的。
   - 在可见生存期内活动总是可见的，即便无法交互。
   - 一般会在onStart()对资源进行加载，onStop()对资源进行释放。
3. 前台生存期
   - 在onResume()和onPause()间所经历的。
   - 在前台生存期内活动总是处于运行状态，可以交互。